<!DOCTYPE html>
<html lang="ja">

<head>

  <meta charset="UTF-8">
  <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <![endif]-->
  <meta name="viewport" content="target-densitydpi=device-dpi, width=980, maximum-scale=1.0, user-scalable=yes">
  <meta name="description" content="DESCRIPTION">
  <meta name="keywords" content="KEYWORDS">
  <meta name="author" content="Seino">

  <title>TITLE</title>

  <link rel="stylesheet" href="css/common.css" media='all'>
  <!--[if lt IE 9]>
    <script src="javascripts/html5shiv.min.js"></script>
  <![endif]-->
  <script src="js/lib/jquery.min.js"></script>
  <script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.0.0/pixi.min.js"></script>
  <link rel="shortcut icon" href="">
  <!--
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="196x196" href="">
    <link rel="apple-touch-icon" sizes="152x152" href="">
  -->

</head>

<body id="index">

  <div class="container">

    <header class="header clearfix" id="page-top">
      <h1>

      </h1>
    </header>

    <div class="contents">
      <main class="content-main">
        <nav>
          <button type="button" id="createjs">Use Create.js</button>
          <button type="button" id="pixijs">Use Pixi.js</button>
        </nav>
      </main><!--/content-main-->


    </div><!--/contents-->

  </div>
  <!--/container-->

</body>
<script>
  $('#createjs').one('click',function() {
    $('#pixijs').remove();
    $('<canvas id="demoCanvas" width="1000" height="600"></canvas>').appendTo('main');
    var stage = new createjs.Stage("demoCanvas");
    stage.name = "stage";
    stage.mouseMoveOutside = true;
    stage.enableMouseOver(10);

    stage.on("stagemouseup", function(evt) {
      // console.log(evt.relatedTarget);
      // var evt = {};
      // evt.stageX = 100;
      // evt.stageY = 100;
      if(!evt.relatedTarget) {
        var sticky = new createjs.Container(),
        sticky_bg = new createjs.Shape(),
        sticky_bg_shadow = new createjs.Shadow("rgba(0,0,0,.3)", 1, 1, 3),
        sticky_label = new createjs.Text("test", "14px", "#333333");

        sticky_label.textAlign = "center";
        sticky_label.textBaseline = "middle";
        sticky_label.x = 0;
        sticky_label.y = 0;

        sticky_bg.graphics.beginFill("#fbf6e8").drawRect(0,0,100,100);
        sticky_bg.shadow = sticky_bg_shadow;
        sticky_bg.regX = 50;
        sticky_bg.regY = 50;
        sticky_bg.x = 0;
        sticky_bg.y = 0;
        sticky.addChild(sticky_bg);
        sticky.addChild(sticky_label);

        sticky.cursor = "pointer";
        sticky.x = evt.stageX;
        sticky.y = evt.stageY;
        stage.addChild(sticky);

        stage.update();

        var mouse = {
            x : 0,
            y : 0
        };

        sticky.on("mousedown", function(evt) {
          // console.log(evt);
          sticky_bg_shadow.blur = 10;
          sticky_bg_shadow.offsetX = 3;
          sticky_bg_shadow.offsetY = 3;
          mouse.x = evt.localX;
          mouse.y = evt.localY;
        });
        sticky.on("pressmove", function(evt) {
          // console.log(evt);
          // console.log('move');
          sticky.x = evt.stageX - mouse.x;
          sticky.y = evt.stageY - mouse.y;
          stage.update();
        });
        sticky.on("pressup", function(evt) {
          sticky_bg_shadow.blur = 3;
          sticky_bg_shadow.offsetX = 1;
          sticky_bg_shadow.offsetY = 1;
          stage.update();
        });
      }
    });
  });
  $('#pixijs').one('click',function() {
    $('#createjs').remove();
    var renderer = new PIXI.autoDetectRenderer(1000, 600, {antialias: true,transparent:true});
    $('main').append(renderer.view);

    var stage = new PIXI.Container();

    //テクスチャの生成
    var texture = new PIXI.RenderTexture(renderer);
    var rd = new PIXI.Graphics()
    rd.beginFill(0xFBF6E8);
    rd.drawRect(0, 0, 100, 100)
    rd.endFill()
    texture.render(rd);

    //ボタンの生成
    var button = new PIXI.Sprite(texture);
    button.anchor.x = 0.5;
    button.anchor.y = 0.5;
    button.position.x = 1000 * 0.5;
    button.position.y = 600 * 0.5;

    //タッチイベント(マウスイベント)を有効化
    // button.interactive = true;
    stage.interactive = true;
    //ボタンをステージに追加
    stage.addChild(button);
    //イベントの追加
    // button
    // .on('click', function () {
    //   alert('button clicked');
    // });
    stage
    .on('click', function () {
      alert('stage clicked');
    });

    renderer.render(stage);
    console.log(renderer);
  });
</script>

</html>
